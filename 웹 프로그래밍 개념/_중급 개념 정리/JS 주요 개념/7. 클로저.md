# j7. 클로저

: 클로저는 함수를 **일급 객체**로 취급하는 함수형 프로그래밍 언어에서 사용되는 중요한 특성

<br>

#### [일급 객체]

----

: 특정 언어에서 **객체(object)**가 아래 조건 모두 만족

- **변수(variable)에 담을 수 있다**
- **인자(argument)로 전달 할 수 있다**
- **반환값(return value)으로 전달할 수 있다**

<br>

#### [JS는 일급 객체, 일급 함수이다]

----

: JS 1급 함수 (런타임 생성 가능, 익명 생성 가능 조건) 조건에도 성립.

: 하지만 **함수도 객체**이기때문에 보통 일급 객체라고 만 한다.

<br>

#### [JS에서의 클로저]

----

: **독립적인 (자유) 변수를 가리키는 함수**

: **클로저 안에 정의된 함수는 만들어진 환경을 '기억한다'**

```js
const outer = () => {
	const x = 10;
	const inner = () => { console.log(x); };
	return inner;
}

const inner = outer();
inner();  // 10   .  이때 외부 함수 저장한 변수를 함수형태로 호출하는거 중요!!!!
```

```
함수 outer는 내부 함수 inner 반환하고 생을 마감.
하지만 위 코드의 실행 결과는 변수 x의 값인 10.

!! 마치, 이미 생명 끝나서 실행 컨텍스트 스택에서 제거된 함수 outer의 지역변수 x가 부활한듯 동작 ㄷㄷ

이처럼!
자신을 포함하고 있는 외부함수보다 내부함수가 더 오래 유지되는 경우
밖에서 내부함수 호출되도 외부함수의 지역변수에 접근 가능한데

이런 함수를 클로저라고 한다.
```

<br>

#### [클로저의 활용]

----

: **클로저는 자신이 생성될때의 환경을 기억해야해서 메모리 적으로는 손해**

: 하지만 기능적으로는 유용!

1. **상태 유지**

   : **현재 상태를 기억하고 변경된 최신 상태를 유지**하는데 가장 유용하게 사용

   ```js
   const toggle = (function () {
       var isShow = false;
   
       // ① 클로저를 반환
       return () => {
         box.style.display = isShow ? 'block' : 'none';
         // ③ 상태 변경
         isShow = !isShow;
       };
     })();
   ```

   : toggle 함수는 화살표 함수로 바꾸면 실행이 안됨..

   <br>

2. **전역 변수 사용 억제 @@@@@@@@@@@!!!**

   : 전역 변수는 다른 곳에서 접근 가능하고, 이를 임의로 변경시 오류 발생할 수도 있어서, **클로저내 변수로 저장후 사용 권장**

   ```js
   let counter = 0;
   
   function increase() {
   	return ++counter;
   }
   ```

   ```js
   function increase() {
   	let counter = 0;
   	return ++counter;
   }
   
   button.onClick = function() {
   	count.innerHTML = increase();
   }
   ```

   <br>

3. **정보의 은닉**

   : 외부에서 직접 접근 방지하기위해 클로저 사용.

<br>

#### [클로저와 콜백에 대해]

----

: 보통 **콜백 함수를 return 하는 함수를 만들어는 이론이 클로저이다**



